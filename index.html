<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Noor VPN</title>

<style>
body{
margin:0;
font-family:tahoma;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
color:#fff;
text-align:center;
}

.container{
max-width:520px;
margin:auto;
padding:20px;
}

.card{
background:rgba(255,255,255,0.05);
backdrop-filter:blur(10px);
padding:20px;
border-radius:18px;
margin-bottom:20px;
box-shadow:0 10px 30px rgba(0,0,0,0.3);
}

button{
background:linear-gradient(45deg,#ff9800,#ff5722);
border:none;
color:white;
padding:14px;
border-radius:12px;
cursor:pointer;
margin-top:12px;
width:100%;
font-weight:bold;
font-size:15px;
}

.hidden{display:none;}

.plan-card{
background:rgba(255,255,255,0.08);
padding:15px;
border-radius:14px;
cursor:pointer;
border:2px solid transparent;
margin-top:10px;
}

.plan-card.active{
border:2px solid #ff9800;
background:rgba(255,152,0,0.15);
}

input{
width:100%;
padding:12px;
margin-top:10px;
border-radius:10px;
border:none;
font-size:14px;
}
</style>
</head>

<body>

<div class="container">

<!-- HOME -->
<div id="home" class="page">
<div class="card">
<h2>ğŸš€ Ø®Ø±ÛŒØ¯ VPN Ù¾Ø±Ø³Ø±Ø¹Øª</h2>
<button onclick="showPage('plans')">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾Ù„Ù†â€ŒÙ‡Ø§</button>
</div>
</div>

<!-- PLANS -->
<div id="plans" class="page hidden">
<div class="card">
<h3>Ø§Ù†ØªØ®Ø§Ø¨ Ù¾Ù„Ù†</h3>

<div class="plan-card" onclick="selectPlan(this,'10 Ú¯ÛŒÚ¯',80000)">10 Ú¯ÛŒÚ¯ - 80,000</div>
<div class="plan-card" onclick="selectPlan(this,'20 Ú¯ÛŒÚ¯',120000)">20 Ú¯ÛŒÚ¯ - 120,000</div>
<div class="plan-card" onclick="selectPlan(this,'30 Ú¯ÛŒÚ¯',180000)">30 Ú¯ÛŒÚ¯ - 180,000</div>
<div class="plan-card" onclick="selectPlan(this,'50 Ú¯ÛŒÚ¯',300000)">50 Ú¯ÛŒÚ¯ - 300,000</div>

<button onclick="goToPayment()">Ø§Ø¯Ø§Ù…Ù‡</button>
<button onclick="showPage('home')">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
</div>
</div>

<!-- PAYMENT -->
<div id="payment" class="page hidden">
<div class="card">
<h3>Ù¾Ø±Ø¯Ø§Ø®Øª</h3>

<div id="selectedPlan"></div>
<div>Ù…Ø¨Ù„Øº: <strong id="priceBox"></strong></div>

<hr>

Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª:<br>
<strong>6219861850746008</strong><br>
Ø¨Ù‡ Ù†Ø§Ù…: Ø³Ø§Ù… Ø±Ù†Ø¬Ø¨Ø±

<hr>

<input type="text" id="telegramId" placeholder="Ø¢ÛŒØ¯ÛŒ ØªÙ„Ú¯Ø±Ø§Ù…">
<input type="file" id="receipt">

<button onclick="sendOrder()">Ø§Ø±Ø³Ø§Ù„ ÙÛŒØ´</button>
<button onclick="showPage('home')">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
</div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const SUPABASE_URL = "https://einjufpqfwwwomutyliu.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_tN0r-fIK19hTI6ucKPuvhA_5V8ueB9B";

const supabaseClient = supabase.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
);

let selectedPlan = "";
let selectedPrice = 0;

function showPage(id){
document.querySelectorAll(".page").forEach(p=>p.classList.add("hidden"));
document.getElementById(id).classList.remove("hidden");
}

function selectPlan(element,plan,price){
document.querySelectorAll(".plan-card").forEach(c=>c.classList.remove("active"));
element.classList.add("active");
selectedPlan=plan;
selectedPrice=price;
}

function goToPayment(){
if(!selectedPlan){alert("Ù¾Ù„Ù† Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†");return;}
document.getElementById("selectedPlan").innerText="Ù¾Ù„Ù†: "+selectedPlan;
document.getElementById("priceBox").innerText=
Number(selectedPrice).toLocaleString("en-US")+" ØªÙˆÙ…Ø§Ù†";
showPage("payment");
}

async function sendOrder(){

if(!selectedPlan){alert("Ù¾Ù„Ù† Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†");return;}

let tg=document.getElementById("telegramId").value.trim();
if(!tg){alert("Ø¢ÛŒØ¯ÛŒ ØªÙ„Ú¯Ø±Ø§Ù… Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†");return;}
if(!tg.startsWith("@")) tg="@"+tg;

let fileInput=document.getElementById("receipt");
if(fileInput.files.length===0){alert("ÙÛŒØ´ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†");return;}

const file=fileInput.files[0];
const fileName=Date.now()+"-"+file.name;

// upload
const {error:uploadError}=await supabaseClient
.storage.from("receipts")
.upload(fileName,file);

if(uploadError){alert("Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ù„ÙˆØ¯");return;}

const {data}=supabaseClient
.storage.from("receipts")
.getPublicUrl(fileName);

const receiptUrl=data.publicUrl;

// insert
const {error:insertError}=await supabaseClient
.from("orders")
.insert([{plan:selectedPlan,
price:selectedPrice+" ØªÙˆÙ…Ø§Ù†",
telegram_id:tg,
receipt_url:receiptUrl
}]);

if(insertError){alert("Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´");return;}



alert("Ø³ÙØ§Ø±Ø´ Ø«Ø¨Øª Ø´Ø¯ âœ…");
showPage("home");
}
</script>

</body>
</html>